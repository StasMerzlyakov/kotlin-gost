/*
 * Created by Stanislav Merzlyakov
 * st.merzlyakov@yandex.ru
 *  in May-2022.
 */

package su.ztech.sespake.p5011132016

import kotlin.test.Test
import kotlin.test.assertContentEquals

class HMacTest {

    @Test
    fun hMac256Test() {

        val key = ubyteArrayOf(
            0x00u, 0x01u, 0x02u, 0x03u, 0x04u, 0x05u, 0x06u, 0x07u, 0x08u, 0x09u, 0x0au, 0x0bu, 0x0cu, 0x0du, 0x0eu, 0x0fu,
            0x10u, 0x11u, 0x12u, 0x13u, 0x14u, 0x15u, 0x16u, 0x17u, 0x18u, 0x19u, 0x1au, 0x1bu, 0x1cu, 0x1du, 0x1eu, 0x1fu
        )

        val inputT = ubyteArrayOf(0x01u, 0x26u, 0xbdu, 0xb8u, 0x78u, 0x00u, 0xafu, 0x21u, 0x43u, 0x41u, 0x45u, 0x65u, 0x63u, 0x78u, 0x01u, 0x00u)

        val hmac = hmacGostR34112012256(key, inputT)

        val expected = ubyteArrayOf(
            0xa1u, 0xaau, 0x5fu, 0x7du, 0xe4u, 0x02u, 0xd7u, 0xb3u, 0xd3u, 0x23u, 0xf2u, 0x99u, 0x1cu, 0x8du, 0x45u, 0x34u,
            0x01u, 0x31u, 0x37u, 0x01u, 0x0au, 0x83u, 0x75u, 0x4fu, 0xd0u, 0xafu, 0x6du, 0x7cu, 0xd4u, 0x92u, 0x2eu, 0xd9u
        )

        assertContentEquals(expected, hmac)
    }

    @Test
    fun hMac512Test() {

        val key = ubyteArrayOf(
            0x00u, 0x01u, 0x02u, 0x03u, 0x04u, 0x05u, 0x06u, 0x07u, 0x08u, 0x09u, 0x0au, 0x0bu, 0x0cu, 0x0du, 0x0eu, 0x0fu,
            0x10u, 0x11u, 0x12u, 0x13u, 0x14u, 0x15u, 0x16u, 0x17u, 0x18u, 0x19u, 0x1au, 0x1bu, 0x1cu, 0x1du, 0x1eu, 0x1fu
        )

        val inputT = ubyteArrayOf(0x01u, 0x26u, 0xbdu, 0xb8u, 0x78u, 0x00u, 0xafu, 0x21u, 0x43u, 0x41u, 0x45u, 0x65u, 0x63u, 0x78u, 0x01u, 0x00u)

        val hmac = hmacGostR34112012512(key, inputT)

        assertContentEquals(
            ubyteArrayOf(
                0xa5u, 0x9bu, 0xabu, 0x22u, 0xecu, 0xaeu, 0x19u, 0xc6u, 0x5fu, 0xbdu, 0xe6u, 0xe5u, 0xf4u, 0xe9u, 0xf5u, 0xd8u,
                0x54u, 0x9du, 0x31u, 0xf0u, 0x37u, 0xf9u, 0xdfu, 0x9bu, 0x90u, 0x55u, 0x00u, 0xe1u, 0x71u, 0x92u, 0x3au, 0x77u,
                0x3du, 0x5fu, 0x15u, 0x30u, 0xf2u, 0xedu, 0x7eu, 0x96u, 0x4cu, 0xb2u, 0xeeu, 0xdcu, 0x29u, 0xe9u, 0xadu, 0x2fu,
                0x3au, 0xfeu, 0x93u, 0xb2u, 0x81u, 0x4fu, 0x79u, 0xf5u, 0x00u, 0x0fu, 0xfcu, 0x03u, 0x66u, 0xc2u, 0x51u, 0xe6u
            ),
            hmac
        )
    }
}
